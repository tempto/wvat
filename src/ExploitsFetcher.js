/**
 * Obtains the hyperlink to the known vulnerabilities for a given CVE
 * @param {string} cve Common Vulnerability/Exposure code
 * @throws {Error} Missing cve
 * @returns {string} Hyperlink to known vulnerabilities list
 */
const getCVEExploitsUrl = (cve) => {
    if (!cve) throw new Error("Missing cve");

    return `https://www.exploit-db.com/search?cve=${cve}`;
};

/**
 * Obtains the hyperlinks to the known vulnerabilities for each CVE from a given list
 * @param {Array} cve_list Set of Common Vulnerability/Exposure codes
 * @throws {Error} Missing cve list
 * @returns {Array} Set of hyperlinks to known vulnerabilities lists
 */
const getCVEListExploitsUrls = (cve_list) => {
    if (!cve_list) throw new Error("Missing cve list");

    return cve_list.map((cve) => ({
        cve,
        url: getCVEExploitsUrl(cve),
    }));
};

module.exports = {
    getCVEExploitsUrl,
    getCVEListExploitsUrls,
};
