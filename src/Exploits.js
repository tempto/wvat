const { isNumOnlyCVE } = require("./utils");

/**
 * Obtains the hyperlink to the known vulnerabilities for a given CVE in Exploit-DB (https://www.exploit-db.com)
 * @param {string} cve Common Vulnerability/Exposure code (in number only format, e.g. 2019-1234 or 2019-1234567)
 * @throws {Error} Missing cve
 * @throws {Error} Invalid cve format
 * @returns {string} Hyperlink to known vulnerabilities list
 */
const getExploitsDBExploitsUrl = (cve) => {
    if (!cve) throw new Error("Missing cve");
    if (!isNumOnlyCVE(cve)) throw new Error("Invalid cve format. Expected format: XXXX-YYYY");

    return `https://www.exploit-db.com/search?cve=${cve}`;
};

module.exports = {
    getExploitsDBExploitsUrl,
};
