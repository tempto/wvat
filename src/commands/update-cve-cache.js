const Command = require("../BaseCommand");
const Logger = require("../Logger");
const Errors = require("../errors");
const {
    updateLocalCVECache,
} = require("../CVEs");

class UpdateCVECacheCommand extends Command {
    async run() {
        await this.parse(UpdateCVECacheCommand);

        Logger.print("Downloading CVEs database ...");

        try {
            await updateLocalCVECache();
        } catch (e) {
            Logger.print(Errors.CVE_LOCAL_CACHE_UPDATE.description);
            process.exit(Errors.CVE_LOCAL_CACHE_UPDATE.code);
        }

        Logger.print("\nDone.");
    }
}

UpdateCVECacheCommand.description = "Updates local CVE cache file";

module.exports = UpdateCVECacheCommand;
