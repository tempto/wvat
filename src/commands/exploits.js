const Command = require("../BaseCommand");
const Logger = require("../Logger");
const { getExploitDatabasesUrls } = require("../Exploits");

class ExploitsCommand extends Command {
    run() {
        const { args, flags } = this.parse(ExploitsCommand);
        this.setup(flags);

        const cve = args.cve;

        const exploit_databases_hyperlinks = getExploitDatabasesUrls(cve);

        Logger.print(JSON.stringify(exploit_databases_hyperlinks, null, 2));
    }
}

ExploitsCommand.description = "Searches known exploits for a given CVE";

ExploitsCommand.args = [
    {
        name: "cve",
        required: true,
        description: "CVE to search know exploits",
        hidden: false,
    },
];

module.exports = ExploitsCommand;
