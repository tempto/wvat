const { getExploitsListUrl } = require("../src/ExploitsFetcher");

describe("Exploits Fetcher tests", () => {
    describe("Exploits list url", () => {
        it("should build the exploits website url", () => {
            const cve = "2019-1017";
            expect(getExploitsListUrl(cve)).toEqual(
                `https://www.exploit-db.com/search?cve=${cve}`,
            );
        });

        it("should fail when the cve is missing", () => {
            expect(() => getExploitsListUrl()).toThrowError(new Error("Missing cve"));
        });
    });
});
